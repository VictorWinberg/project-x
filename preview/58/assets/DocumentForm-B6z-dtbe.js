import{b as v,u as x,a as f}from"./useSnackbar-CG4DoqUX.js";import{v as D,j as e,m as p,b1 as R,b2 as M,b3 as H,b4 as K,b5 as Q,f as S,r as m,G as i,l as j,B as P,S as V}from"./index-DvKsnGam.js";import{u as G,C as w}from"./index.esm-CPLMXBxn.js";import{F as N,s as O}from"./FlexGrow-0LbDvL8o.js";const $=D(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),z=D(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),_=()=>v({queryKey:["files"],queryFn:K}),ee=t=>v({queryKey:["file",t],queryFn:()=>Q(t),enabled:!!t}),te=()=>{const t=p(),{showSnackbar:n}=x();return f({mutationFn:R,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),n("Dokumentet sparat!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle sparas.","error")}})},ne=()=>{const t=p(),{showSnackbar:n}=x();return f({mutationFn:M,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),n("Dokumentet uppdatarat!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle uppdateras.","error")}})},re=()=>{const t=p(),{showSnackbar:n}=x();return f({mutationFn:H,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),n("Dokumentet borttaget!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle tas bort.","error")}})},A=({onChange:t,children:n,...u})=>{const d=c=>{c.target.files&&(t==null||t(c.target.files[0]))};return e.jsxs(S,{component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(z,{}),...u,children:[n,e.jsx("input",{type:"file",style:{display:"none"},onChange:d})]})},se=({onSubmit:t=()=>{},onChange:n,formProps:u,children:d,...c})=>{const{control:h,handleSubmit:k,watch:g,setValue:y,formState:{errors:q}}=G(u),[b,E]=m.useState(null),l=m.useRef(null),W=()=>{if(l.current&&l.current.contentWindow){const r=l.current.contentWindow.document,a=r.documentElement.scrollHeight,F=r.documentElement.scrollWidth,U=l.current.clientHeight,B=l.current.clientWidth/F,C=U/a,L=Math.min(B,C);r.body.style.transform=`scale(${L})`,r.body.style.transformOrigin="top left",r.body.style.width=`${F}px`,r.body.style.height=`${a}px`}},s=g();m.useEffect(()=>{n==null||n(s)},[n,s]);const I=o=>{y("documentName",o.name),y("content",o),E(URL.createObjectURL(o))};return e.jsx(N,{...c,children:e.jsxs("form",{onSubmit:k(t),style:{...O},children:[e.jsxs(i,{container:!0,spacing:2,children:[e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(w,{control:h,name:"documentName",rules:{required:!0},defaultValue:"",render:({field:o,fieldState:r})=>e.jsx(j,{fullWidth:!0,label:"Dokumentnamn",type:"text",margin:"none",...o,error:!!r.error})})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(w,{control:h,name:"content",rules:{required:!0},render:({field:o})=>{var r,a;return e.jsx(j,{fullWidth:!0,label:"Fil",type:"text",margin:"none",value:((r=o.value)==null?void 0:r.name)||"",disabled:!0,error:!!q.content,InputProps:{endAdornment:(a=s.content)==null?void 0:a.type}})}})}),e.jsx(i,{item:!0,xs:12,children:b&&e.jsx(P,{component:"iframe",ref:l,src:b,title:"PDF Preview",onLoad:W,style:{width:"100%",height:"500px",border:"none"}})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(V,{spacing:2,direction:"row",children:[e.jsx(A,{onChange:I,children:s.content?"Ersätt fil":"Välj fil"}),e.jsx(S,{startIcon:e.jsx($,{}),variant:"contained",href:s.content?URL.createObjectURL(s.content):"#",download:s.documentName,disabled:!s.content,children:"Ladda ner"})]})})]}),d]})})};export{se as D,te as a,ne as b,re as c,ee as d,_ as u};
