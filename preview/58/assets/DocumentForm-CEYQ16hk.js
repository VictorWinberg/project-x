import{b as D,u as y,a as F}from"./useSnackbar-BIwXbGf-.js";import{v as E,j as e,m as b,b1 as g,b2 as q,b3 as I,b4 as U,b5 as W,f as k,r as h,B as v,G as d,l as w,S as B}from"./index-D4PCSPab.js";import{u as L,C as S}from"./index.esm-CkxpF-Ht.js";import{F as R,s as C}from"./FlexGrow-C2SJ6O5x.js";const P=E(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),M=E(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),N=()=>D({queryKey:["files"],queryFn:U}),$=n=>D({queryKey:["file",n],queryFn:()=>W(n),enabled:!!n}),z=()=>{const n=b(),{showSnackbar:t}=y();return F({mutationFn:g,onSuccess:()=>{n.invalidateQueries({queryKey:["files"]}),t("Dokumentet sparat!")},onError:()=>{t("Ett fel uppstod när dokumentet skulle sparas.","error")}})},A=()=>{const n=b(),{showSnackbar:t}=y();return F({mutationFn:q,onSuccess:()=>{n.invalidateQueries({queryKey:["files"]}),t("Dokumentet uppdatarat!")},onError:()=>{t("Ett fel uppstod när dokumentet skulle uppdateras.","error")}})},Y=()=>{const n=b(),{showSnackbar:t}=y();return F({mutationFn:I,onSuccess:()=>{n.invalidateQueries({queryKey:["files"]}),t("Dokumentet borttaget!")},onError:()=>{t("Ett fel uppstod när dokumentet skulle tas bort.","error")}})},H=({onChange:n,children:t,...a})=>{const i=c=>{var u;const r=(u=c.target.files)==null?void 0:u[0];r&&(n==null||n(r))};return e.jsxs(k,{component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(M,{}),...a,children:[t,e.jsx("input",{type:"file",style:{display:"none"},onChange:i})]})},K=["application/pdf","application/json","image/*","text/*","video/*","audio/*"],Q=({file:n})=>{const t=h.useRef(null),[a,i]=h.useState();h.useEffect(()=>{n&&K.some(r=>n.type.match(r))?i(URL.createObjectURL(n)):i(void 0)},[n]);const c=()=>{if(t.current&&t.current.contentWindow){const r=t.current,m=t.current.contentWindow.document,x=r.clientHeight,j=r.clientWidth,s=m.documentElement.scrollHeight,p=m.documentElement.scrollWidth,o=j/p,l=x/s,f=Math.min(o,l);r.style.transform=`scale(${f})`,r.style.transformOrigin="top left",r.style.width=`${p}px`,r.style.height=`${s}px`}};return a?e.jsx(v,{sx:{mx:-1,overflow:"hidden"},children:e.jsx(v,{sx:{width:"100%",height:"500px",px:1},children:e.jsx("iframe",{ref:t,src:a,title:"Preview",onLoad:c,style:{width:"100%",height:"500px",border:"none"}})},a)}):null},_=({onSubmit:n=()=>{},onChange:t,formProps:a,children:i,...c})=>{const{control:r,handleSubmit:u,watch:m,setValue:x,formState:{errors:j}}=L(a),s=m();h.useEffect(()=>{t==null||t(s)},[t,s]);const p=o=>{x("documentName",o.name),x("content",o)};return e.jsx(R,{...c,children:e.jsxs("form",{onSubmit:u(n),style:{...C},children:[e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(S,{control:r,name:"documentName",rules:{required:!0},defaultValue:"",render:({field:o,fieldState:l})=>e.jsx(w,{fullWidth:!0,label:"Dokumentnamn",type:"text",margin:"none",...o,error:!!l.error})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(S,{control:r,name:"content",rules:{required:!0},render:({field:o})=>{var l,f;return e.jsx(w,{fullWidth:!0,label:"Fil",type:"text",margin:"none",value:((l=o.value)==null?void 0:l.name)||"",disabled:!0,error:!!j.content,InputProps:{endAdornment:(f=s.content)==null?void 0:f.type}})}})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(Q,{file:s.content})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(B,{spacing:2,direction:"row",children:[e.jsx(H,{onChange:p,children:s.content?"Ersätt fil":"Välj fil"}),e.jsx(k,{startIcon:e.jsx(P,{}),variant:"contained",href:s.content?URL.createObjectURL(s.content):"#",download:s.documentName,disabled:!s.content,children:"Ladda ner"})]})})]}),i]})})};export{_ as D,z as a,A as b,Y as c,$ as d,N as u};
