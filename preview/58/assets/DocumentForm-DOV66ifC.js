import{b,u as c,a as d}from"./useSnackbar-DsA2jCXT.js";import{v,j as e,m,b1 as I,b2 as U,b3 as C,b4 as g,b5 as B,f as S,r as h,G as o,l as j,S as K}from"./index-BUqGPT5o.js";import{u as L,C as y}from"./index.esm-DpspE6AT.js";import{F as M,s as Q}from"./FlexGrow-CnLeMwbi.js";const R=v(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),V=v(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),O=()=>b({queryKey:["files"],queryFn:g}),T=t=>b({queryKey:["file",t],queryFn:()=>B(t),enabled:!!t}),W=()=>{const t=m(),{showSnackbar:r}=c();return d({mutationFn:I,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),r("Dokumentet sparat!")},onError:()=>{r("Ett fel uppstod när dokumentet skulle sparas.","error")}})},H=()=>{const t=m(),{showSnackbar:r}=c();return d({mutationFn:U,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),r("Dokumentet uppdatarat!")},onError:()=>{r("Ett fel uppstod när dokumentet skulle uppdateras.","error")}})},J=()=>{const t=m(),{showSnackbar:r}=c();return d({mutationFn:C,onSuccess:()=>{t.invalidateQueries({queryKey:["files"]}),r("Dokumentet borttaget!")},onError:()=>{r("Ett fel uppstod när dokumentet skulle tas bort.","error")}})},G=({onChange:t,children:r,...i})=>{const u=a=>{a.target.files&&(t==null||t(a.target.files[0]))};return e.jsxs(S,{component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:e.jsx(V,{}),...i,children:[r,e.jsx("input",{type:"file",style:{display:"none"},onChange:u})]})},X=({onSubmit:t=()=>{},onChange:r,formProps:i,children:u,...a})=>{const{control:x,handleSubmit:k,watch:D,setValue:p,formState:{errors:w}}=L(i),[f,q]=h.useState(null),s=D();h.useEffect(()=>{r==null||r(s)},[r,s]);const E=n=>{p("documentName",n.name),p("content",n),q(URL.createObjectURL(n))};return e.jsx(M,{...a,children:e.jsxs("form",{onSubmit:k(t),style:{...Q},children:[e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(y,{control:x,name:"documentName",rules:{required:!0},defaultValue:"",render:({field:n,fieldState:l})=>e.jsx(j,{fullWidth:!0,label:"Dokumentnamn",type:"text",margin:"none",...n,error:!!l.error})})}),e.jsx(o,{item:!0,xs:12,sm:6,children:e.jsx(y,{control:x,name:"content",rules:{required:!0},render:({field:n})=>{var l,F;return e.jsx(j,{fullWidth:!0,label:"Fil",type:"text",margin:"none",value:((l=n.value)==null?void 0:l.name)||"",disabled:!0,error:!!w.content,InputProps:{endAdornment:(F=s.content)==null?void 0:F.type}})}})}),e.jsx(o,{item:!0,xs:12,children:f&&e.jsx("iframe",{src:f,title:"Preview",style:{width:"100%",height:"500px"}})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(K,{spacing:2,direction:"row",children:[e.jsx(G,{onChange:E,children:s.content?"Ersätt fil":"Välj fil"}),e.jsx(S,{startIcon:e.jsx(R,{}),variant:"contained",href:s.content?URL.createObjectURL(s.content):"#",download:s.documentName,disabled:!s.content,children:"Ladda ner"})]})})]}),u]})})};export{X as D,W as a,H as b,J as c,T as d,O as u};
