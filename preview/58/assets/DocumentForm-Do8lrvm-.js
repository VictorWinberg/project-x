import{b as E,u as w,a as y}from"./useSnackbar-DZ4BKLUb.js";import{v as S,j as t,m as j,b1 as k,b2 as W,b3 as q,b4 as I,b5 as L,f as D,r as d,B as U,G as x,l as b,S as B}from"./index-P76RY24s.js";import{u as H,C as v}from"./index.esm-BcsoVM4q.js";import{F as R,s as C}from"./FlexGrow-CDI5m-M2.js";const P=S(t.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),M=S(t.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),A=()=>E({queryKey:["files"],queryFn:I}),Y=e=>E({queryKey:["file",e],queryFn:()=>L(e),enabled:!!e}),_=()=>{const e=j(),{showSnackbar:n}=w();return y({mutationFn:k,onSuccess:()=>{e.invalidateQueries({queryKey:["files"]}),n("Dokumentet sparat!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle sparas.","error")}})},X=()=>{const e=j(),{showSnackbar:n}=w();return y({mutationFn:W,onSuccess:()=>{e.invalidateQueries({queryKey:["files"]}),n("Dokumentet uppdatarat!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle uppdateras.","error")}})},J=()=>{const e=j(),{showSnackbar:n}=w();return y({mutationFn:q,onSuccess:()=>{e.invalidateQueries({queryKey:["files"]}),n("Dokumentet borttaget!")},onError:()=>{n("Ett fel uppstod när dokumentet skulle tas bort.","error")}})},T=({onChange:e,children:n,...r})=>{const i=a=>{var s;const c=(s=a.target.files)==null?void 0:s[0];c&&(e==null||e(c))};return t.jsxs(D,{component:"label",role:void 0,variant:"contained",tabIndex:-1,startIcon:t.jsx(M,{}),...r,children:[n,t.jsx("input",{type:"file",style:{display:"none"},onChange:i})]})};function z(){const[e,n]=d.useState([window.innerWidth,window.innerHeight]);return d.useEffect(()=>{const r=K(()=>{n([window.innerWidth,window.innerHeight])},200);return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),e}const K=(e,n)=>{let r;return(...i)=>{let a;return clearTimeout(r),r=setTimeout(()=>{a=e(...i)},n),a}},Q=["application/pdf","application/json","image/*","text/*","video/*","audio/*"],O=({file:e})=>{const n=z(),r=d.useRef(null),[i,a]=d.useState();d.useEffect(()=>{e&&Q.some(s=>e.type.match(s))?a(URL.createObjectURL(e)):a(void 0)},[e]);const c=()=>{if(r.current&&r.current.contentWindow){const s=r.current,m=r.current.contentWindow.document,h=s.clientHeight,o=s.clientWidth,f=m.documentElement.scrollHeight,l=m.documentElement.scrollWidth,u=o/l,p=h/f,g=Math.min(u,p);s.style.transform=`scale(${g})`,s.style.transformOrigin="top left",s.style.width=`${l}px`,s.style.height=`${f}px`}};return i?t.jsx(U,{sx:{width:"100%",height:"500px",px:1,mx:-1},children:t.jsx("iframe",{ref:r,src:i,title:"Preview",onLoad:c,style:{width:"100%",height:"500px",border:"none"}})},i+n):null},Z=({onSubmit:e=()=>{},onChange:n,formProps:r,children:i,...a})=>{const{control:c,handleSubmit:s,watch:F,setValue:m,formState:{errors:h}}=H(r),o=F();d.useEffect(()=>{n==null||n(o)},[n,o]);const f=l=>{m("documentName",l.name),m("content",l)};return t.jsx(R,{...a,children:t.jsxs("form",{onSubmit:s(e),style:{...C},children:[t.jsxs(x,{container:!0,spacing:2,children:[t.jsx(x,{item:!0,xs:12,sm:6,children:t.jsx(v,{control:c,name:"documentName",rules:{required:!0},defaultValue:"",render:({field:l,fieldState:u})=>t.jsx(b,{fullWidth:!0,label:"Dokumentnamn",type:"text",margin:"none",...l,error:!!u.error})})}),t.jsx(x,{item:!0,xs:12,sm:6,children:t.jsx(v,{control:c,name:"content",rules:{required:!0},render:({field:l})=>{var u,p;return t.jsx(b,{fullWidth:!0,label:"Fil",type:"text",margin:"none",value:((u=l.value)==null?void 0:u.name)||"",disabled:!0,error:!!h.content,InputProps:{endAdornment:(p=o.content)==null?void 0:p.type}})}})}),t.jsx(x,{item:!0,xs:12,children:t.jsx(O,{file:o.content})}),t.jsx(x,{item:!0,xs:12,children:t.jsxs(B,{spacing:2,direction:"row",children:[t.jsx(T,{onChange:f,children:o.content?"Ersätt fil":"Välj fil"}),t.jsx(D,{startIcon:t.jsx(P,{}),variant:"contained",href:o.content?URL.createObjectURL(o.content):"#",download:o.documentName,disabled:!o.content,children:"Ladda ner"})]})})]}),i]})})};export{Z as D,_ as a,X as b,J as c,Y as d,A as u};
