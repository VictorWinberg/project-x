import{i as R,k,r as L,j as e,T,B as d,g as A,L as M,h as S,t as $,S as E,f as l}from"./index-k4d9V8K3.js";import{t as V,D as B,a as u,b as g,c as p,M as x}from"./useSnackbar-DoVFsvi6.js";import{u as N,a as P,b as Y,c as _,d as z,D as h}from"./useDocumentsMutations-CPn8pmyv.js";import{C as H}from"./ContentTabs-TdpeJZEc.js";import{F as U}from"./FlexGrow-oL42Qray.js";import{u as G,a as K,A as q}from"./useAssignmentsMutations-nNMZ_7K0.js";import{a as w}from"./useAssignmentsQueries-7T2ZUcQK.js";import"./MoreHoriz-0sSJqMxU.js";import"./index.esm-CEnFQkWy.js";import"./Tooltip-DwfCoNX8.js";import"./useContactsQueries-DIPrYhVp.js";const oe=()=>{const o=R(),r=k(),{data:a,isLoading:j}=w(o.id==="new"?void 0:Number(o.id)),{mutate:f}=G(),{mutate:y}=K(),{data:i=[],isLoading:D}=N(),{data:c=[],isLoading:b}=P({entityType:"assignment",entityId:`${a==null?void 0:a.assignmentId}`}),I=L.useMemo(()=>{const t=V(i,"documentId");return c.map(n=>({...n,...t.get(n.documentId)}))},[i,c]),{mutate:m}=Y(),{mutate:C}=_(),{mutate:v}=z(),F=t=>{a?y(t):f(t,{onSuccess:n=>r(`/dashboard/assignments/${n.assignmentId}`)})};if(!j)return e.jsxs(e.Fragment,{children:[e.jsx(T,{variant:"h4",color:"primary",children:a?"Redigera uppdrag":"LÃ¤gg till uppdrag"}),e.jsx(d,{sx:{my:1}}),e.jsxs(q,{formProps:{values:a},onSubmit:F,children:[e.jsx(d,{sx:{my:1}}),a&&e.jsx(U,{children:e.jsx(H,{tabs:[{label:"Interaktioner",content:e.jsx(e.Fragment,{children:"Interaktioner..."})},{label:"Dokument",content:e.jsx(B,{data:I,getRowId:t=>`${t.documentId}-${t.entityType}-${t.entityId}`,state:{isLoading:D||b},columns:[{accessorKey:"documentName",header:"Dokumentnamn",Cell:({cell:t,row:n})=>e.jsx(A,{component:M,to:`/documents/${n.original.documentId}`,children:t.getValue()})},{accessorFn:t=>{var n;return(n=t.content)==null?void 0:n.type},header:"Filtyp",enableEditing:!1},{accessorFn:t=>{var n;return S((n=t.content)==null?void 0:n.lastModified)},header:"Senast uppdaterad",filterVariant:"date-range",enableEditing:!1,Cell:({cell:t})=>$(t.getValue()).format("YYYY-MM-DD HH:mm")}],renderCreateRowDialogContent:({row:t,table:n})=>e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"h4",color:"primary",children:"Nytt dokument"}),e.jsx(g,{children:e.jsx(h,{sx:{mt:1},formProps:{defaultValues:{entityType:"assignment",entityId:`${a.assignmentId}`}},onChange:s=>{t._valuesCache=s}})}),e.jsx(p,{children:e.jsx(x,{row:t,table:n,variant:"text"})})]}),renderEditRowDialogContent:({row:t,table:n})=>e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"h4",color:"primary",children:"Redigera dokument"}),e.jsx(g,{children:e.jsx(h,{sx:{mt:1},formProps:{defaultValues:t.original},onChange:s=>{t._valuesCache=s}})}),e.jsx(p,{children:e.jsx(x,{row:t,table:n,variant:"text"})})]}),onCreate:t=>m(t,{onSuccess:n=>C({...t,documentId:n})}),onUpdate:t=>m(t),onDelete:t=>v(t)})},{label:"Intressenter",content:e.jsx(e.Fragment,{children:"Intressenter..."})},{label:"Moduler",content:e.jsx(e.Fragment,{children:"Moduler..."})}],selected:1})}),e.jsxs(E,{spacing:2,direction:"row",sx:{mt:3},children:[e.jsx(l,{size:"large",type:"submit",variant:"contained",color:"primary",children:"Spara"}),e.jsx(l,{size:"large",variant:"outlined",color:"primary",onClick:()=>r(-1),children:"Tillbaka"})]})]})]})};export{oe as default};
