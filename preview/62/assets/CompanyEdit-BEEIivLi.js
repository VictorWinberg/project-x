import{i as S,k as v,j as a,T as L,B as m,g as o,L as s,S as k,f as c,l as F}from"./index-YiW1SVvL.js";import{u as K}from"./useAssignmentsQueries-DouJPN5u.js";import{u as D,a as E,b as T}from"./useContactsMutations-D1Orpbz0.js";import{u as $}from"./useContactsQueries-Ch6MQ3h0.js";import{C as N}from"./ContentTabs-D21CbHus.js";import{D as l,d as P}from"./useSnackbar-Cy_aK-Ek.js";import{F as w}from"./FlexGrow-CiD6N9pi.js";import{u as U,a as V,b as A,C as R}from"./useCompaniesMutations-DdOj_Xjp.js";import{a as z}from"./useCompaniesQueries-BWM99dW2.js";import"./MoreHoriz-BLL1WSyd.js";import"./index.esm-BoixCPhM.js";import"./Tooltip-DIavm8s0.js";const _=()=>{const i=S(),r=v(),{data:n,isLoading:d}=z(i.id==="new"?void 0:Number(i.id)),{mutate:p}=U(),{mutate:g}=V(),{mutate:u}=A(),{data:y=[],isLoading:C}=$(),{data:h=[],isLoading:x}=K(),{mutate:b}=D(),{mutate:j}=E(),{mutate:f}=T(),I=e=>{n?g(e):p(e,{onSuccess:t=>r(`/dashboard/companies/${t.companyId}`)})};if(!d)return a.jsxs(a.Fragment,{children:[a.jsx(L,{variant:"h4",color:"primary",children:n?"Redigera företag":"Lägg till företag"}),a.jsx(m,{sx:{my:1}}),a.jsxs(R,{formProps:{values:n},onSubmit:I,children:[a.jsx(m,{sx:{my:1}}),n&&a.jsx(w,{children:a.jsx(N,{tabs:[{label:"Interaktioner",content:a.jsx(a.Fragment,{children:"Interaktioner..."})},{label:"Kontakter",content:a.jsx(l,{data:y.filter(e=>e.companyId===n.companyId),getRowId:e=>`${e.contactId}`,state:{isLoading:C},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:t})=>a.jsx(o,{component:s,to:`/dashboard/contacts/${t.original.contactId}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],onCreate:e=>b({...e,companyId:n.companyId}),onUpdate:e=>j(e),onDelete:e=>f(e)})},{label:"Söker",content:a.jsx(a.Fragment,{children:"Söker..."})},{label:"Uppdrag",content:a.jsx(l,{data:h.filter(e=>{var t;return((t=e.externalContactPerson)==null?void 0:t.companyId)===n.companyId}),getRowId:e=>`${e.assignmentId}`,state:{isLoading:x},columns:[{accessorKey:"assignmentName",header:"Uppdrag",Cell:({cell:e,row:t})=>a.jsx(o,{component:s,to:`/dashboard/assignments/${t.original.assignmentId}`,children:e.getValue()})},{accessorFn:e=>{var t;return(t=e.responsiblePerson)==null?void 0:t.contactName},header:"Ansvarig",enableEditing:!1,Cell:({cell:e,row:t})=>a.jsx(o,{component:s,to:`/dashboard/contacts/${t.original.responsiblePersonId}`,children:e.getValue()})},{accessorFn:e=>{var t;return(t=e.externalContactPerson)==null?void 0:t.contactName},header:"Extern",enableEditing:!1,Cell:({cell:e,row:t})=>a.jsx(o,{component:s,to:`/dashboard/contacts/${t.original.externalContactPersonId}`,children:e.getValue()})},{accessorKey:"status",header:"Status"},{accessorKey:"fee",header:"Arvode",Cell:({cell:e})=>e.getValue().toLocaleString("sv-SE",{style:"currency",currency:"SEK",minimumFractionDigits:0,maximumFractionDigits:0})}]})},{label:"KYC",content:a.jsx(a.Fragment,{children:"KYC..."})}],selected:1})}),a.jsxs(k,{spacing:2,direction:"row",sx:{mt:3,ml:"auto"},children:[n&&a.jsx(P,{onClick:()=>u(n,{onSuccess:()=>r("..")}),children:e=>a.jsx(c,{size:"large",variant:"outlined",color:"error",...F(e),children:"Ta bort"})}),a.jsx(c,{size:"large",variant:"outlined",color:"primary",onClick:()=>r(-1),children:"Avbryt"}),a.jsx(c,{size:"large",type:"submit",variant:"contained",color:"primary",children:"Spara"})]})]})]})};export{_ as default};
