import{g as S,h as k,j as a,T as v,B as m,i as s,L as o,S as L,f as i,l as F}from"./index-ddI1K0Uz.js";import{u as K}from"./useAssignmentsQueries-CURbVvZS.js";import{u as D,a as E,b as T}from"./useContactsMutations-D4JyyZiO.js";import{u as $}from"./useContactsQueries-PP6qFhMy.js";import{C as N}from"./ContentTabs-CrW_MpZD.js";import{D as l,a as P}from"./DataTable-xYdK4KFx.js";import{F as w}from"./FlexGrow-Dzo_CAs5.js";import{u as U,a as V,b as A,C as R}from"./useCompaniesMutations-DUvHXjWa.js";import{a as z}from"./useCompaniesQueries-Dk_jIta1.js";import"./useSnackbar-CvIRoW3l.js";import"./MoreHoriz-CNDzEBJ8.js";import"./index.esm-Dhb3aMtu.js";import"./Tooltip-DoNkApSW.js";import"./useQueryParam-yYHqQwSD.js";const ae=()=>{const c=S(),r=k(),{data:n,isLoading:d}=z(c.id==="new"?void 0:Number(c.id)),{mutate:p}=U(),{mutate:g}=V(),{mutate:u}=A(),{data:y=[],isLoading:h}=$(),{data:C=[],isLoading:x}=K(),{mutate:b}=D(),{mutate:j}=E(),{mutate:f}=T(),I=e=>{n?g(e):p(e,{onSuccess:t=>r(`/dashboard/companies/${t.companyId}`)})};if(!d)return a.jsxs(a.Fragment,{children:[a.jsx(v,{variant:"h4",color:"primary",children:n?"Redigera företag":"Lägg till företag"}),a.jsx(m,{sx:{my:1}}),a.jsxs(R,{formProps:{values:n},onSubmit:I,children:[a.jsx(m,{sx:{my:1}}),n&&a.jsx(w,{children:a.jsx(N,{tabs:[{id:"interactions",label:"Interaktioner",content:a.jsx(a.Fragment,{children:"Interaktioner..."})},{id:"contacts",label:"Kontakter",content:a.jsx(l,{data:y.filter(e=>e.companyId===n.companyId),getRowId:e=>`${e.contactId}`,state:{isLoading:h},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:t})=>a.jsx(s,{component:o,to:`/dashboard/contacts/${t.original.contactId}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],onCreate:e=>b({...e,companyId:n.companyId}),onUpdate:e=>j(e),onDelete:e=>f(e)})},{id:"seeking",label:"Söker",content:a.jsx(a.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:a.jsx(l,{data:C.filter(e=>{var t;return((t=e.externalContactPerson)==null?void 0:t.companyId)===n.companyId}),getRowId:e=>`${e.assignmentId}`,state:{isLoading:x},columns:[{accessorKey:"assignmentName",header:"Uppdrag",Cell:({cell:e,row:t})=>a.jsx(s,{component:o,to:`/dashboard/assignments/${t.original.assignmentId}`,children:e.getValue()})},{accessorFn:e=>{var t;return(t=e.responsiblePerson)==null?void 0:t.contactName},header:"Ansvarig",enableEditing:!1,Cell:({cell:e,row:t})=>a.jsx(s,{component:o,to:`/dashboard/contacts/${t.original.responsiblePersonId}`,children:e.getValue()})},{accessorFn:e=>{var t;return(t=e.externalContactPerson)==null?void 0:t.contactName},header:"Extern",enableEditing:!1,Cell:({cell:e,row:t})=>a.jsx(s,{component:o,to:`/dashboard/contacts/${t.original.externalContactPersonId}`,children:e.getValue()})},{accessorKey:"status",header:"Status"},{accessorKey:"fee",header:"Arvode",Cell:({cell:e})=>e.getValue().toLocaleString("sv-SE",{style:"currency",currency:"SEK",minimumFractionDigits:0,maximumFractionDigits:0})}]})},{id:"kyc",label:"KYC",content:a.jsx(a.Fragment,{children:"KYC..."})}]})}),a.jsxs(L,{spacing:2,direction:"row",sx:{mt:3,ml:"auto"},children:[n&&a.jsx(P,{onClick:()=>u(n,{onSuccess:()=>r("..")}),children:e=>a.jsx(i,{size:"large",variant:"outlined",color:"error",...F(e),children:"Ta bort"})}),a.jsx(i,{size:"large",variant:"outlined",color:"primary",onClick:()=>r(-1),children:"Avbryt"}),a.jsx(i,{size:"large",type:"submit",variant:"contained",color:"primary",children:"Spara"})]})]})]})};export{ae as default};
